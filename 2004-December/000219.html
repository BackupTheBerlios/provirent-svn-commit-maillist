<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Provirent-svn-commit] r218 - in project_src/provirent_hibernate/src: de/hsharz/provirent/management/gui test/provirent/hibernate
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/provirent-svn-commit/2004-December/index.html" >
   <LINK REL="made" HREF="mailto:provirent-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BProvirent-svn-commit%5D%20r218%20-%20in%20project_src/provirent_hibernate/src%3A%20de/hsharz/provirent/management/gui%20test/provirent/hibernate&In-Reply-To=%3C200412071804.iB7I4iNo022590%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000218.html">
   <LINK REL="Next"  HREF="000220.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Provirent-svn-commit] r218 - in project_src/provirent_hibernate/src: de/hsharz/provirent/management/gui test/provirent/hibernate</H1>
    <B>Philipp Schneider at BerliOS</B> 
    <A HREF="mailto:provirent-svn-commit%40lists.berlios.de?Subject=Re%3A%20%5BProvirent-svn-commit%5D%20r218%20-%20in%20project_src/provirent_hibernate/src%3A%20de/hsharz/provirent/management/gui%20test/provirent/hibernate&In-Reply-To=%3C200412071804.iB7I4iNo022590%40sheep.berlios.de%3E"
       TITLE="[Provirent-svn-commit] r218 - in project_src/provirent_hibernate/src: de/hsharz/provirent/management/gui test/provirent/hibernate">pschneider at sheep.berlios.de
       </A><BR>
    <I>Tue Dec  7 19:04:44 CET 2004</I>
    <P><UL>
        <LI>Previous message: <A HREF="000218.html">[Provirent-svn-commit] r217 - project_src/provirent_hibernate/src/de/hsharz/provirent/management/gui/language
</A></li>
        <LI>Next message: <A HREF="000220.html">[Provirent-svn-commit] r219 - project_src/provirent_hibernate/src/test/provirent/hibernate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#219">[ date ]</a>
              <a href="thread.html#219">[ thread ]</a>
              <a href="subject.html#219">[ subject ]</a>
              <a href="author.html#219">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: pschneider
Date: 2004-12-07 19:04:42 +0100 (Tue, 07 Dec 2004)
New Revision: 218

Modified:
   project_src/provirent_hibernate/src/de/hsharz/provirent/management/gui/CompositeImage.java
   project_src/provirent_hibernate/src/test/provirent/hibernate/HibernateUtil.java
   project_src/provirent_hibernate/src/test/provirent/hibernate/TestMovie.java
Log:


Modified: project_src/provirent_hibernate/src/de/hsharz/provirent/management/gui/CompositeImage.java
===================================================================
--- project_src/provirent_hibernate/src/de/hsharz/provirent/management/gui/CompositeImage.java	2004-12-07 16:56:07 UTC (rev 217)
+++ project_src/provirent_hibernate/src/de/hsharz/provirent/management/gui/CompositeImage.java	2004-12-07 18:04:42 UTC (rev 218)
@@ -1285,20 +1285,36 @@
 
         final int width = imgdata.width;
         final int height = imgdata.height;
-        float scalefactor = 1;
-
-        if (width &gt; maxwidth) {
-            scalefactor = (float) maxwidth / width;
-        }
-        if (height &gt; maxheight) {
-            if (((float) maxheight / height) &lt; scalefactor) {
-                scalefactor = ((float) maxheight / height);
+        
+        int new_width = imgdata.width;
+        int new_height = imgdata.height;
+        
+        
+        float ratio = (float)( (float)width / (float)height);
+        
+        if (width &gt; height){
+            //breiter als h&#246;her
+            logger.debug(&quot;breiter Ratio: &quot;+ratio);
+            if(width &gt; maxwidth) {
+               new_width = maxwidth;
+               new_height =(int)( maxwidth /( ratio ));
             }
-
+        } else {
+            //h&#246;her als breiter
+            logger.debug(&quot;h&#246;her Ratio: &quot;+ratio);
+            if (height &gt; maxheight){
+                new_height = maxheight;
+                new_width = (int)( (double)new_height * ratio);
+                    
+            }
         }
+        
 
+        
+        logger.debug(&quot;w:&quot;+new_width+&quot; h:&quot;+new_height+&quot; r:&quot;+ratio);
+
         return new Image(getDisplay(), imgdata.scaledTo(
-                (int) (width * scalefactor), (int) (height * scalefactor)));
+                (int) (new_width), (int) (new_height)));
 
     }
 }
\ No newline at end of file

Modified: project_src/provirent_hibernate/src/test/provirent/hibernate/HibernateUtil.java
===================================================================
--- project_src/provirent_hibernate/src/test/provirent/hibernate/HibernateUtil.java	2004-12-07 16:56:07 UTC (rev 217)
+++ project_src/provirent_hibernate/src/test/provirent/hibernate/HibernateUtil.java	2004-12-07 18:04:42 UTC (rev 218)
@@ -32,11 +32,14 @@
  */
 package test.provirent.hibernate;
 
+
 import net.sf.hibernate.HibernateException;
 import net.sf.hibernate.Session;
 import net.sf.hibernate.SessionFactory;
 import net.sf.hibernate.cfg.Configuration;
 
+import net.sf.hibernate.expression.Expression;
+
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.log4j.Logger;
@@ -132,6 +135,44 @@
     }
 
     
+	public static Image getImagename(final String filter, Session s){
+        if (logger.isDebugEnabled()) {
+            logger
+                    .debug(&quot;getImagename(String filter = &quot; + filter
+                            + &quot;) - start&quot;);
+        }
+	    
+	    //init the returnlist
+	    Image returnimg = null;
+
+	    
+	    try {
+
+	            
+
+	        returnimg = (Image) s.createCriteria(Image.class).add(
+                    Expression.eq(&quot;imageFileName&quot;, filter)).list().get(0);
+            
+            if (logger.isDebugEnabled()) {
+                logger.debug(&quot;getImagename(String) - end&quot;);
+            }
+	
+
+	
+	
+	    } catch (Exception e) {
+            logger.error(&quot;getImagename(String)&quot;, e);
+
+	        logger.error(
+	                &quot;getImagename() - Error while trying to do Transaction&quot;,
+	                e);
+	        returnimg = null;
+	    }
+	    return returnimg;
+	    	
+	}
+	
+	
     
     
 }
\ No newline at end of file

Modified: project_src/provirent_hibernate/src/test/provirent/hibernate/TestMovie.java
===================================================================
--- project_src/provirent_hibernate/src/test/provirent/hibernate/TestMovie.java	2004-12-07 16:56:07 UTC (rev 217)
+++ project_src/provirent_hibernate/src/test/provirent/hibernate/TestMovie.java	2004-12-07 18:04:42 UTC (rev 218)
@@ -55,7 +55,7 @@
 
 /**
  * @author Philipp Schneider
- *
+ *  
  */
 public class TestMovie extends TestCase {
     /**
@@ -77,180 +77,120 @@
         super.tearDown();
     }
 
-    
-
     /**
-     * Creates a new Movie objects and saves it.
-     * All data will be create new.
+     * Creates a new Movie objects and saves it. All data will be create new.
+     * 
      * @throws Exception
      */
-    public void testCreateCompleteNewMovie() throws Exception{
+    public void testCreateCompleteNewMovie() throws Exception {
         if (logger.isDebugEnabled()) {
             logger.debug(&quot;testCreateCompleteNewMovie() - start&quot;);
         }
-/*
-        //get new Session and begin Transaction
-        Session s = HibernateUtil.currentSession();
-        Transaction tx = null;
-        try {
-            tx = s.beginTransaction();
+        /*
+         * //get new Session and begin Transaction Session s =
+         * HibernateUtil.currentSession(); Transaction tx = null; try { tx =
+         * s.beginTransaction();
+         * 
+         * try { //is DB open and connected assertTrue(&quot;Connected to Db? &quot;,
+         * s.isConnected()); assertTrue(&quot;Db Open? &quot;, s.isOpen());
+         * 
+         * List movies = new ArrayList();
+         * 
+         * //create new movie objects Movie movie = new Movie();
+         * movie.setDescription(&quot;A grieving mother, Telly Parada, &quot; + &quot;is
+         * struggling to cope with the loss of her &quot; +&quot;9-year-old son. She is
+         * stunned...&quot;); movie.setRuntime(96); movie.setTitle(&quot;The Forgotten&quot;);
+         * movie.setReleaseDate(Calendar.getInstance());
+         * 
+         * movie.setImages(new ArrayList()); //Image mainImage = new Image();
+         * 
+         * movie.setMainImage(new Image());
+         * 
+         * 
+         * List objects = new ArrayList(); objects.add(new
+         * Actor(&quot;Julianne&quot;,&quot;Moore&quot;)); objects.add(new Actor(&quot;Christopher&quot;,
+         * &quot;Kovaleski&quot;)); objects.add(new Actor(&quot;Matthew&quot;, &quot;Pleszewicz&quot;)); for
+         * (Iterator iter = objects.iterator(); iter.hasNext();) { s.save(
+         * iter.next() ); } movie.setActors(objects);
+         * 
+         * objects = new ArrayList(); objects.add(new
+         * Director(&quot;Joseph&quot;,&quot;Ruben&quot;)); for (Iterator iter = objects.iterator();
+         * iter.hasNext();) { s.save( iter.next() ); }
+         * movie.setDirector(objects);
+         * 
+         * objects = new ArrayList(); objects.add(new Genre(&quot;Thriller&quot;,&quot;&quot;));
+         * objects.add(new Genre(&quot;Drama&quot;,&quot;&quot;)); objects.add(new
+         * Genre(&quot;Sci-Fi&quot;,&quot;&quot;)); objects.add(new Genre(&quot;Mystery&quot;,&quot;&quot;)); for
+         * (Iterator iter = objects.iterator(); iter.hasNext();) { s.save(
+         * iter.next() ); } movie.setGenres(objects);
+         * 
+         * objects = new ArrayList(); objects.add(new Language(&quot;Deutsch&quot;,&quot;de&quot;));
+         * objects.add(new Language(&quot;Englisch&quot;,&quot;en&quot;)); for (Iterator iter =
+         * objects.iterator(); iter.hasNext();) { s.save( iter.next() ); }
+         * movie.setLanguages(objects);
+         * 
+         * objects = new ArrayList(); objects.add( new AudioFormat(&quot;DTS Surround
+         * Sound&quot;,&quot;&quot;)); objects.add( new AudioFormat(&quot;Surround Sound&quot;,&quot;&quot;));
+         * objects.add( new AudioFormat(&quot;Dolby&quot;,&quot;&quot;)); for (Iterator iter =
+         * objects.iterator(); iter.hasNext();) { s.save( iter.next() ); }
+         * movie.setAudioFormats(new ArrayList());
+         * 
+         * objects = new ArrayList(); objects.add(new Subtitle(&quot;Deutsch&quot;,&quot;de&quot;));
+         * objects.add(new Subtitle(&quot;Englisch&quot;,&quot;en&quot;)); for (Iterator iter =
+         * objects.iterator(); iter.hasNext();) { s.save( iter.next() ); }
+         * movie.setSubtitles(objects);
+         * 
+         * objects = new ArrayList(); objects.add( new VideoFormat(&quot;9:13&quot;,&quot;&quot;));
+         * objects.add( new VideoFormat(&quot;16:10&quot;, &quot;&quot;)); for (Iterator iter =
+         * objects.iterator(); iter.hasNext();) { s.save( iter.next() ); }
+         * movie.setVideoFormats(new ArrayList());
+         * 
+         * //add movie to movie List movies.add(movie);
+         * 
+         * 
+         * List ids = new ArrayList();
+         * 
+         * //save objects for (Iterator iter = movies.iterator();
+         * iter.hasNext();) { Movie moviee = (Movie) iter.next();
+         * ids.add((Integer) s.save(moviee));
+         *  } s.flush();
+         * 
+         * for (int i =0;i &lt; ids.size(); i++) {
+         * 
+         * int id = ((Integer)ids.get(i)).intValue();
+         * 
+         * //get Condition from Hibernate Movie dbc = (Movie) s.get(Movie.class,
+         * new Integer(id)); assertNotNull(&quot;Can't get Movie&quot; + id + &quot; from DB&quot;,
+         * dbc); if (dbc == null) { if (logger.isDebugEnabled()) {
+         * logger.debug(&quot;testCreateCompleteNewMovie() Kein object mit id &quot; + id +
+         * &quot;gefunden.&quot;); } return; } Movie mym = (Movie)movies.get(i); //are
+         * both equal? assertEquals( &quot;Select: Customer aus DB nicht gleich
+         * meiner. DB: &quot; + dbc + &quot; My:&quot; + mym, mym, dbc);
+         * 
+         * }//for
+         * 
+         * tx.commit();
+         *  } catch (Exception e) { if (tx != null) { logger .error(
+         * &quot;testCreateCompleteNewMovie() - Something went wrong here; discard
+         * all partial changes&quot;, e);
+         *  // Something went wrong; discard all partial changes tx.rollback(); } }
+         *  } catch (Exception e) { logger.error( &quot;testCreateCompleteNewMovie() -
+         * Error while trying to beginTransaction&quot;, e); throw e; } finally { //
+         * No matter what, close the session HibernateUtil.closeSession(); }
+         *  
+         */
 
-            try {
-                //is DB open and connected
-                assertTrue(&quot;Connected to Db? &quot;, s.isConnected());
-                assertTrue(&quot;Db Open? &quot;, s.isOpen());
-
-                List movies = new ArrayList();
-                
-                //create new movie objects
-                Movie movie = new Movie();
-                movie.setDescription(&quot;A grieving mother, Telly Parada, &quot; +
-                        &quot;is struggling to cope with the loss of her &quot;
-                        +&quot;9-year-old son. She is stunned...&quot;);
-                movie.setRuntime(96);
-                movie.setTitle(&quot;The Forgotten&quot;);
-                movie.setReleaseDate(Calendar.getInstance());
-
-                movie.setImages(new ArrayList());
-                //Image mainImage = new Image();
-
-                movie.setMainImage(new Image());                
-                
-                
-                List objects = new ArrayList();
-                objects.add(new Actor(&quot;Julianne&quot;,&quot;Moore&quot;));
-                objects.add(new Actor(&quot;Christopher&quot;, &quot;Kovaleski&quot;));
-                objects.add(new Actor(&quot;Matthew&quot;, &quot;Pleszewicz&quot;));
-                for (Iterator iter = objects.iterator(); iter.hasNext();) {
-                    s.save( iter.next() );
-                }
-                movie.setActors(objects);
-
-                objects = new ArrayList();
-                objects.add(new Director(&quot;Joseph&quot;,&quot;Ruben&quot;));
-                for (Iterator iter = objects.iterator(); iter.hasNext();) {
-                    s.save( iter.next() );
-                }
-                movie.setDirector(objects);
-
-                objects = new ArrayList();
-                objects.add(new Genre(&quot;Thriller&quot;,&quot;&quot;));
-                objects.add(new Genre(&quot;Drama&quot;,&quot;&quot;));
-                objects.add(new Genre(&quot;Sci-Fi&quot;,&quot;&quot;));
-                objects.add(new Genre(&quot;Mystery&quot;,&quot;&quot;));
-                for (Iterator iter = objects.iterator(); iter.hasNext();) {
-                    s.save( iter.next() );
-                }
-                movie.setGenres(objects);
-              
-                objects = new ArrayList();
-                objects.add(new Language(&quot;Deutsch&quot;,&quot;de&quot;));
-                objects.add(new Language(&quot;Englisch&quot;,&quot;en&quot;));
-                for (Iterator iter = objects.iterator(); iter.hasNext();) {
-                    s.save( iter.next() );
-                }
-                movie.setLanguages(objects);
-
-                objects = new ArrayList();
-                objects.add( new AudioFormat(&quot;DTS Surround Sound&quot;,&quot;&quot;));
-                objects.add( new AudioFormat(&quot;Surround Sound&quot;,&quot;&quot;));
-                objects.add( new AudioFormat(&quot;Dolby&quot;,&quot;&quot;));
-                for (Iterator iter = objects.iterator(); iter.hasNext();) {
-                    s.save( iter.next() );
-                }
-                movie.setAudioFormats(new ArrayList());
-                
-                objects = new ArrayList();
-                objects.add(new Subtitle(&quot;Deutsch&quot;,&quot;de&quot;));
-                objects.add(new Subtitle(&quot;Englisch&quot;,&quot;en&quot;));
-                for (Iterator iter = objects.iterator(); iter.hasNext();) {
-                    s.save( iter.next() );
-                }
-                movie.setSubtitles(objects);
-
-                objects = new ArrayList();
-                objects.add( new VideoFormat(&quot;9:13&quot;,&quot;&quot;));
-                objects.add( new VideoFormat(&quot;16:10&quot;, &quot;&quot;));
-                for (Iterator iter = objects.iterator(); iter.hasNext();) {
-                    s.save( iter.next() );
-                }
-                movie.setVideoFormats(new ArrayList());
-                
-                //add movie to movie List
-                movies.add(movie);
-
-                
-                List ids = new ArrayList();
-
-                //save objects
-                for (Iterator iter = movies.iterator(); iter.hasNext();) {
-                    Movie moviee = (Movie) iter.next();
-                    ids.add((Integer) s.save(moviee));
-
-                }
-                s.flush();
-
-                for (int i =0;i &lt; ids.size(); i++) {
-                    
-                    int id = ((Integer)ids.get(i)).intValue();
-                    
-                    //get Condition from Hibernate
-                    Movie dbc = (Movie) s.get(Movie.class, new Integer(id));
-                    assertNotNull(&quot;Can't get Movie&quot; + id + &quot; from DB&quot;, dbc);
-                    if (dbc == null) {
-                        if (logger.isDebugEnabled()) {
-                            logger.debug(&quot;testCreateCompleteNewMovie() Kein object mit id &quot;
-                                    + id + &quot;gefunden.&quot;);
-                        }
-                        return;
-                    }
-                    Movie mym = (Movie)movies.get(i);
-                    //are both equal?
-                    assertEquals(
-                            &quot;Select: Customer aus DB nicht gleich meiner. DB: &quot;
-                                    + dbc + &quot; My:&quot; + mym, mym, dbc); 
-
-                }//for
-                
-                tx.commit();
-                
-            } catch (Exception e) {
-                if (tx != null) {
-                    logger
-                            .error(
-                                    &quot;testCreateCompleteNewMovie() - Something went wrong here; discard all partial changes&quot;,
-                                    e);
-
-                    // Something went wrong; discard all partial changes
-                    tx.rollback();
-                }
-            }
-
-        } catch (Exception e) {
-            logger.error(
-                    &quot;testCreateCompleteNewMovie() - Error while trying to beginTransaction&quot;,
-                    e);
-            throw e;
-        } finally {
-            // No matter what, close the session
-            HibernateUtil.closeSession();
-        }
-        
-        */
-        
         if (logger.isDebugEnabled()) {
             logger.debug(&quot;testCreateCompleteNewMovie() - end&quot;);
         }
     }
 
-    
     /**
-     * Creates a new Movie Objects,
-     * tries to get all data like Actor from db
+     * Creates a new Movie Objects, tries to get all data like Actor from db
      * 
      * @throws Exception
      */
-    public void testCreateDBMovie() throws Exception{
+    public void testCreateDBMovie() throws Exception {
         if (logger.isDebugEnabled()) {
             logger.debug(&quot;testCreateDBMovie() - start&quot;);
         }
@@ -258,7 +198,7 @@
         //get new Session and begin Transaction
         Session s = HibernateUtil.currentSession();
         Transaction tx = null;
-        
+
         RandomRange random;
         List randomNum = new ArrayList();
         try {
@@ -269,186 +209,211 @@
                 assertTrue(&quot;Connected to Db? &quot;, s.isConnected());
                 assertTrue(&quot;Db Open? &quot;, s.isOpen());
 
-                
                 logger.debug(&quot;Erstelle Movie Objekt&quot;);
-                
+
                 List data = new ArrayList();
-                data.add(new String[]{&quot;The Forgotten&quot;,&quot;96&quot;,&quot;A grieving mother, Telly Parada, is struggling to cope with the loss of her 9-year-old son. She is stunned...&quot;,&quot;Forgotten_main.jpg&quot;,&quot;Forgotten_1.gif&quot;,&quot;Forgotten_2.gif&quot; });
-                data.add(new String[]{&quot;Ocean's Twelve&quot;,&quot;128&quot;,&quot;With Tess (Roberts) and Rusty (Pitt) at his side, Daniel Ocean (Clooney) must find one more conspirator before he can pull off heists in three different European cities -- Paris, Rome, and Amsterdam.&quot;,&quot;Twelve_main.gif&quot;,&quot;Twelve_1.gif&quot;,&quot;Twelve_2.gif&quot;,&quot;Twelve_3.gif&quot;});
-                data.add(new String[]{&quot;Blade: Trinity&quot;,&quot;156&quot;,&quot;Framed by the Vampire Nation for a series of brutal murders, the Daywalker (Snipes) finds allies in a group of vampire hunters, the Nightstalkers, and together they wage a battle that leads all the way to Dracula himself.&quot;,&quot;Blade_main.gif&quot;,&quot;Blade_1.gif&quot;,&quot;Blade_2.gif&quot;,&quot;Blade_3.gif&quot;});
-                data.add(new String[]{&quot;National Treasure&quot;,&quot;126&quot;,&quot;Benjamin Franklin Gates (Cage) descends from a family of treasure-seekers who've all hunted for the same thing: a war chest hidden by the Founding Fathers prior to the Revolutionary War. Ben's close to discovering its whereabouts, as is his competition, though the FBI is also hip to the hunt.&quot;,&quot;Treasure_main.gif&quot;,&quot;Treasure_1.gif&quot;,&quot;Treasure_2.gif&quot;,&quot;Treasure_3.gif&quot;,&quot;Treasure_4.gif&quot;});
-                data.add(new String[]{&quot;Christmas with the Kranks&quot;,&quot;92&quot;,&quot;Upon receiving a last-minute call from their daughter, Luther and Nora Krank (Allen and Curtis) ditch their vacation plans and scramble to get their home in shape to celebrate Christmas.&quot;,&quot;Kranks_main.gif&quot;,&quot;Kranks_1.gif&quot;,&quot;Kranks_2.gif&quot;});
-                data.add(new String[]{&quot;The Polar Express&quot;,&quot;215&quot;,&quot;A boy's belief in Santa Claus is restored on Christmas Eve when a steam train pulls up in front of his house and whisks him away to the North Pole.&quot;,&quot;Polar_main.gif&quot;,&quot;Polar_1.gif&quot;,&quot;Polar_2.gif&quot;,&quot;Polar_3.gif&quot;});
-                data.add(new String[]{&quot;The Incredibles&quot;,&quot;186&quot;,&quot;Years after their last assignment, a husband and wife superhero team, who currently maintain a ho-hum suburban existence, respond a cryptic communiqu&#233; from a remote island base.&quot;,&quot;Incredibles_main.gif&quot;,&quot;Incredibles_1.gif&quot;,&quot;Incredibles_2.gif&quot;});
-                data.add(new String[]{&quot;Closer&quot;,&quot;145&quot;,&quot;Two couples are drawn together by undeniable attraction and a series of chance encounters.&quot;,&quot;closer_main.gif&quot;,&quot;closer_1.gif&quot;,&quot;closer_2.gif&quot;,&quot;closer_3.gif&quot;});
-                
-                for(int k =0; k&lt; data.size(); k++){
-                    
-                    String[] sdata = (String[])data.get(k);
-                //create new movie objects
-                Movie movie = new Movie();
-                //set simple properties
-                movie.setTitle(sdata[0]);
-                movie.setDescription(sdata[2]);
-                movie.setRuntime(Integer.parseInt(sdata[1]));
-                
-                Calendar cal = Calendar.getInstance();
-                cal.set(Calendar.HOUR,0);
-                cal.set(Calendar.MINUTE,0);
-                cal.set(Calendar.SECOND,0);
-                cal.set(Calendar.MILLISECOND,0);
-                movie.setReleaseDate(cal);
-                
-                
-                //try to get Actors from db
-                List  dbprops =  s.find(&quot;from Actor as actor&quot;);
-                assertNotNull(&quot;testCreateDBMovie(): Can't get Actors from DB. Null&quot;, dbprops);
-                assertTrue(&quot;testCreateDBMovie(): Can not find Actors in DB&quot;, dbprops.size() &gt;0);
-                
-                int anzahl =2;
-                List movieprops = new ArrayList();
-                random = new RandomRange(0, (dbprops.size()-1) );
-                randomNum = random.getNumbers(anzahl);
-                for (int i = 0; i &lt; anzahl; i++) {
-                    Actor actor = (Actor)dbprops.get( ((Integer)randomNum.get(i)).intValue() );
-                    movieprops.add(actor);
-                }
-                movie.setActors(movieprops);
-                
+                data
+                        .add(new String[] {
+                                &quot;The Forgotten&quot;,
+                                &quot;96&quot;,
+                                &quot;A grieving mother, Telly Parada, is struggling to cope with the loss of her 9-year-old son. She is stunned...&quot;,
+                                &quot;Forgotten_main.jpg&quot;, &quot;Forgotten_1.jpg&quot;,
+                                &quot;Forgotten_2.jpg&quot; });
+                data
+                        .add(new String[] {
+                                &quot;Ocean's Twelve&quot;,
+                                &quot;128&quot;,
+                                &quot;With Tess (Roberts) and Rusty (Pitt) at his side, Daniel Ocean (Clooney) must find one more conspirator before he can pull off heists in three different European cities -- Paris, Rome, and Amsterdam.&quot;,
+                                &quot;Twelve_main.jpg&quot;, &quot;Twelve_1.jpg&quot;,
+                                &quot;Twelve_2.jpg&quot;, &quot;Twelve_3.jpg&quot; });
+                data
+                        .add(new String[] {
+                                &quot;Blade: Trinity&quot;,
+                                &quot;156&quot;,
+                                &quot;Framed by the Vampire Nation for a series of brutal murders, the Daywalker (Snipes) finds allies in a group of vampire hunters, the Nightstalkers, and together they wage a battle that leads all the way to Dracula himself.&quot;,
+                                &quot;Blade_main.jpg&quot;, &quot;Blade_1.jpg&quot;, &quot;Blade_2.jpg&quot;,
+                                &quot;Blade_3.jpg&quot; });
+                data
+                        .add(new String[] {
+                                &quot;National Treasure&quot;,
+                                &quot;126&quot;,
+                                &quot;Benjamin Franklin Gates (Cage) descends from a family of treasure-seekers who've all hunted for the same thing: a war chest hidden by the Founding Fathers prior to the Revolutionary War. Ben's close to discovering its whereabouts, as is his competition, though the FBI is also hip to the hunt.&quot;,
+                                &quot;Treasure_main.jpg&quot;, &quot;Treasure_1.jpg&quot;,
+                                &quot;Treasure_2.jpg&quot;, &quot;Treasure_3.jpg&quot;,
+                                &quot;Treasure_4.jpg&quot; });
+                data
+                        .add(new String[] {
+                                &quot;Christmas with the Kranks&quot;,
+                                &quot;92&quot;,
+                                &quot;Upon receiving a last-minute call from their daughter, Luther and Nora Krank (Allen and Curtis) ditch their vacation plans and scramble to get their home in shape to celebrate Christmas.&quot;,
+                                &quot;Kranks_main.jpg&quot;, &quot;Kranks_1.jpg&quot;,
+                                &quot;Kranks_2.jpg&quot; });
+                data
+                        .add(new String[] {
+                                &quot;The Polar Express&quot;,
+                                &quot;215&quot;,
+                                &quot;A boy's belief in Santa Claus is restored on Christmas Eve when a steam train pulls up in front of his house and whisks him away to the North Pole.&quot;,
+                                &quot;Polar_main.jpg&quot;, &quot;Polar_1.jpg&quot;, &quot;Polar_2.jpg&quot;,
+                                &quot;Polar_3.jpg&quot; });
+                data
+                        .add(new String[] {
+                                &quot;The Incredibles&quot;,
+                                &quot;186&quot;,
+                                &quot;Years after their last assignment, a husband and wife superhero team, who currently maintain a ho-hum suburban existence, respond a cryptic communiqu&#233; from a remote island base.&quot;,
+                                &quot;Incredibles_main.jpg&quot;, &quot;Incredibles_1.jpg&quot;,
+                                &quot;Incredibles_2.jpg&quot; });
+                data
+                        .add(new String[] {
+                                &quot;Closer&quot;,
+                                &quot;145&quot;,
+                                &quot;Two couples are drawn together by undeniable attraction and a series of chance encounters.&quot;,
+                                &quot;closer_main.jpg&quot;, &quot;closer_1.jpg&quot;,
+                                &quot;closer_2.jpg&quot;, &quot;closer_3.jpg&quot; });
 
-                List objects = new ArrayList();
+                for (int k = 0; k &lt; data.size(); k++) {
 
-                //try to get Directors from db
-                dbprops =  s.find(&quot;from Director as director&quot;);
-                assertNotNull(&quot;testCreateDBMovie(): Can't get Directors from DB. Null&quot;, dbprops);
-                assertTrue(&quot;testCreateDBMovie(): Can not find Directors in DB&quot;, dbprops.size() &gt;0);
-                
-                anzahl =1;
-                movieprops = new ArrayList();
-                random = new RandomRange(0,(dbprops.size()-1));
-                randomNum = random.getNumbers(anzahl);
+                    String[] sdata = (String[]) data.get(k);
+                    //create new movie objects
+                    Movie movie = new Movie();
+                    //set simple properties
+                    movie.setTitle(sdata[0]);
+                    movie.setDescription(sdata[2]);
+                    movie.setRuntime(Integer.parseInt(sdata[1]));
 
-                for (int i = 0; i &lt; anzahl; i++) {
-                    Director prop = (Director)dbprops.get( ((Integer)randomNum.get(i)).intValue() );
-                    movieprops.add(prop);
-                }
-                movie.setDirector(movieprops);
+                    Calendar cal = Calendar.getInstance();
+                    cal.set(Calendar.HOUR, 0);
+                    cal.set(Calendar.MINUTE, 0);
+                    cal.set(Calendar.SECOND, 0);
+                    cal.set(Calendar.MILLISECOND, 0);
+                    movie.setReleaseDate(cal);
 
-                //try to get Genre from db
-                dbprops =  s.find(&quot;from Genre as genre&quot;);
-                assertNotNull(&quot;testCreateDBMovie(): Can't get Genre from DB. Null&quot;, dbprops);
-                assertTrue(&quot;testCreateDBMovie(): Can not find Genre in DB&quot;, dbprops.size() &gt;0);
-                
-                logger.debug(&quot;Anzahl Genres: &quot;+dbprops.size());
-                
-                anzahl =3;
-                movieprops = new ArrayList();
-                random = new RandomRange(0, (dbprops.size()-1) );
-                randomNum = random.getNumbers(anzahl);
+                    //try to get Actors from db
+                    List dbprops = s.find(&quot;from Actor as actor&quot;);
+                    assertNotNull(
+                            &quot;testCreateDBMovie(): Can't get Actors from DB. Null&quot;,
+                            dbprops);
+                    assertTrue(
+                            &quot;testCreateDBMovie(): Can not find Actors in DB&quot;,
+                            dbprops.size() &gt; 0);
 
-                for (int i = 0; i &lt; anzahl; i++) {
-                    Genre prop = (Genre)dbprops.get( ((Integer)randomNum.get(i)).intValue() );
-                    movieprops.add(prop);
-                }
-                movie.setGenres(movieprops);
-                
-                
-                
-                //set MainImage
-                
-                
-                //try to get Images from db
-                dbprops =  s.find(&quot;from Image as image&quot;);
-                assertNotNull(&quot;testCreateDBMovie(): Can't get Image from DB. Null&quot;, dbprops);
-                assertTrue(&quot;testCreateDBMovie(): Can not find Image in DB&quot;, dbprops.size() &gt;0);
+                    int anzahl = 2;
+                    List movieprops = new ArrayList();
+                    random = new RandomRange(0, (dbprops.size() - 1));
+                    randomNum = random.getNumbers(anzahl);
+                    for (int i = 0; i &lt; anzahl; i++) {
+                        Actor actor = (Actor) dbprops.get(((Integer) randomNum
+                                .get(i)).intValue());
+                        movieprops.add(actor);
+                    }
+                    movie.setActors(movieprops);
 
-                logger.debug(&quot;Anzahl Bilder: &quot;+dbprops.size());
-                //set Mainimage
-                anzahl =1;
-                movieprops = new ArrayList();
-                random = new RandomRange(0, (dbprops.size()-1) );
-                randomNum = random.getNumbers(anzahl);
+                    List objects = new ArrayList();
 
-                for (int i = 0; i &lt; anzahl; i++) {
-                    Image prop = (Image)dbprops.get( ((Integer)randomNum.get(i)).intValue() );
-                    movie.setMainImage(prop);
+                    //try to get Directors from db
+                    dbprops = s.find(&quot;from Director as director&quot;);
+                    assertNotNull(
+                            &quot;testCreateDBMovie(): Can't get Directors from DB. Null&quot;,
+                            dbprops);
+                    assertTrue(
+                            &quot;testCreateDBMovie(): Can not find Directors in DB&quot;,
+                            dbprops.size() &gt; 0);
 
-                }
+                    anzahl = 1;
+                    movieprops = new ArrayList();
+                    random = new RandomRange(0, (dbprops.size() - 1));
+                    randomNum = random.getNumbers(anzahl);
 
-                //set images
-                anzahl =3;
-                movieprops = new ArrayList();
-                random = new RandomRange(0, (dbprops.size()-1) );
-                randomNum = random.getNumbers(anzahl);
+                    for (int i = 0; i &lt; anzahl; i++) {
+                        Director prop = (Director) dbprops
+                                .get(((Integer) randomNum.get(i)).intValue());
+                        movieprops.add(prop);
+                    }
+                    movie.setDirector(movieprops);
 
-                for (int i = 0; i &lt; anzahl; i++) {
-                    Image prop = (Image)dbprops.get( ((Integer)randomNum.get(i)).intValue() );
-                    movieprops.add(prop);
+                    //try to get Genre from db
+                    dbprops = s.find(&quot;from Genre as genre&quot;);
+                    assertNotNull(
+                            &quot;testCreateDBMovie(): Can't get Genre from DB. Null&quot;,
+                            dbprops);
+                    assertTrue(&quot;testCreateDBMovie(): Can not find Genre in DB&quot;,
+                            dbprops.size() &gt; 0);
 
-                }
-                movie.setImages(movieprops);
-                
+                    logger.debug(&quot;Anzahl Genres: &quot; + dbprops.size());
 
-                
-               
-                logger.debug(&quot;Speichere Movie Objekt&quot;);
-                
-                
-                //save the new Movie
-                int id = ((Integer)s.save(movie)).intValue();
-                s.flush();
-                logger.debug(&quot;Gespeichert unter id: &quot;+id+&quot; movieid:&quot;+movie.getMovieId());
+                    anzahl = 3;
+                    movieprops = new ArrayList();
+                    random = new RandomRange(0, (dbprops.size() - 1));
+                    randomNum = random.getNumbers(anzahl);
 
-                
-                   
+                    for (int i = 0; i &lt; anzahl; i++) {
+                        Genre prop = (Genre) dbprops.get(((Integer) randomNum
+                                .get(i)).intValue());
+                        movieprops.add(prop);
+                    }
+                    movie.setGenres(movieprops);
 
+                    
+                    //set MainImage
+                    if( HibernateUtil.getImagename(sdata[3],s) != null){
+                        movie.setMainImage(HibernateUtil.getImagename(sdata[3],s));
+                    }
 
-                tx.commit();
+                    //set other Images
+                    movieprops = new ArrayList();
+                    for (int i = 4; i &lt; sdata.length; i++) {
+                        
+                        if(HibernateUtil.getImagename(sdata[i],s) != null) {
+                            movieprops.add(HibernateUtil.getImagename(sdata[i],s));
+                        }
+         
+                    }
+                    movie.setImages(movieprops);
 
-                dbprops =  s.find(&quot;from Movie as Movie&quot;);
-                assertNotNull(&quot;testCreateDBMovie(): Can't get Movie from DB. Null&quot;, dbprops);
-                assertTrue(&quot;testCreateDBMovie(): Can not find Movie in DB&quot;, dbprops.size() &gt;0);
-                
+                    
+                    logger.debug(&quot;Speichere Movie Objekt&quot;);
+
+
+                    s.save(movie);
+                    s.flush();
+                    logger.debug(&quot;ID: &quot;+movie.getMovieId());
+                    tx.commit();
+
+
                 }
-                
-                for (int i = 0; i &lt; dbprops.size(); i++) {
-                    Movie m = (Movie)dbprops.get(i);
-                    logger.debug(i+&quot; Movie:&quot;+m + &quot; Actors: &quot;+m.getActors()+&quot; Director: &quot;+m.getDirector()+&quot; Images: &quot;+m.getImages()+ &quot; Genre: &quot;+m.getGenres());
-                }
-                
-                
-           
-                
+
+
+
             } catch (Exception e) {
                 if (tx != null) {
                     logger
                             .error(
                                     &quot;testCreateCompleteNewMovie() - Something went wrong here; discard all partial changes&quot;,
                                     e);
-                    
+
                     // Something went wrong; discard all partial changes
                     tx.rollback();
                 }
             }
 
         } catch (Exception e) {
-            logger.error(
-                    &quot;testCreateCompleteNewMovie() - Error while trying to beginTransaction&quot;,
-                    e);
+            logger
+                    .error(
+                            &quot;testCreateCompleteNewMovie() - Error while trying to beginTransaction&quot;,
+                            e);
             throw e;
         } finally {
             // No matter what, close the session
             HibernateUtil.closeSession();
         }
-        
-        
-        
+
         if (logger.isDebugEnabled()) {
             logger.debug(&quot;testCreateCompleteNewMovie() - end&quot;);
         }
     }
 
     
+
+    
     /**
      * Constructor for TestMovie.
      * @param arg0
@@ -457,8 +422,4 @@
         super(arg0);
     }
 
-    
-    
-    
-    
-}
+}
\ No newline at end of file


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000218.html">[Provirent-svn-commit] r217 - project_src/provirent_hibernate/src/de/hsharz/provirent/management/gui/language
</A></li>
	<LI>Next message: <A HREF="000220.html">[Provirent-svn-commit] r219 - project_src/provirent_hibernate/src/test/provirent/hibernate
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#219">[ date ]</a>
              <a href="thread.html#219">[ thread ]</a>
              <a href="subject.html#219">[ subject ]</a>
              <a href="author.html#219">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/provirent-svn-commit">More information about the Provirent-svn-commit
mailing list</a><br>
</body></html>
